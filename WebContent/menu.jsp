<%@page import="java.util.Map"%><%@page import="java.util.List"%><%@page import="com.right.dao.MenuDAO"%><%@ page language="java" contentType="text/html; charset=UTF-8"	pageEncoding="UTF-8"%><%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="bootstrap/css/bootstrap.min.css" rel="stylesheet"><script src="jquery/jquery-1.9.1.min.js"></script><script src="bootstrap/js/bootstrap.min.js"></script><title>权限管理</title><script type="text/javascript" >	//处理浏览器直接关闭的	//function checkLeave(){    //if (event.clientX>document.body.clientWidth && event.clientY<0||event.altKey){      //  window.open('check_logout.jsp','',        //        'height=1366,width=768,top=0,left=0');   		 //}	//}	//$(window).bind('beforeunload',function(){return '您输入的内容尚未保存，确定离开此页面吗？';});		//真正起作用的是下面的代码，而且不用body绑定属性	//$(window).bind('beforeunload',function(){		//window.open('check_logout.jsp','', 'height=0,width=0,top=0,left=0');  		//window.open('check_logout.jsp','', 'height=0,width=0,top=0,left=0');  		//return '您输入的内容尚未保存，确定离开此页面吗？';		//}	//);	 //function  checkLeave()        //{        	//if(event.clientX>document.body.clientWidth&&event.clientY<0||event.altKey)          // {   	    	// window.open('check_logout.jsp','',	    		//               'height=1366,width=768,top=0,left=0');  		           //}        //}		//处理浏览器关闭结束	//修改	function modify() {		var chk_id = document.getElementsByName("chk_id");		var mod = document.getElementById("mod");		var i = 0;		for (; i < chk_id.length; i++) {			if (chk_id[i].checked == true)				break;		}		//由于如果全部遍历完，就说明没有找到，所以就等于length长度		if (i == chk_id.length) {			alert("未选择！");			mod.setAttribute('data-target', '');		} else {			mod.setAttribute('data-target', '#modify_modal');			//mod.setAttribute('href', 'menu_modify.jsp?id='				//			+ chk_id[i].value);						mod.setAttribute('href', 'menu!modify.action?id='					+ chk_id[i].value);		}		$("#modify_modal").on("hidden.bs.modal", function() {			$(this).removeData("bs.modal");		});	}		function delete1(){		console.log("delete1");		var chk_id = document.getElementsByName("chk_id");		var del_id = document.getElementById("del");		var j = 0;		//也不能一个id，就break.		//for (; j < chk_id.length; j++) {		//	if (chk_id[j].checked == true)		//		break;		//}				//错了，在javascript使用了java代码，应该是在html中嵌入jsp代码。				//List<Map<String, Object>> menuList = new ArrayList<Map<String, Object>>();				var chk_ids = new Array();		var k=0;		for(;j<chk_id.length;j++){							if (chk_id[j].checked == true){				//console.log("enter if");				//console.log(chk_id[j].value);								chk_ids[k]=chk_id[j].value;				//chk_ids[j]=chk_id[j];				//javaScript和java的输出是不一样的，不能用System.out.println				//break;				//javaScript要用i=0,否则它不知道是什么类型								//这样输出的结果就是这样				//--------------226-230				k++;			}		}				console.log("遍历");		//for(k=0;k<chk_ids.length;k++){			//console.log(chk_ids[k]);			//chk_ids.join("-");		//}						str = chk_ids.join("-");		//alert(str);		//console.log(" menu str"+str);		//console.log("str"+str);		//console.log("遍历--");		//for(k=0;k<chk_ids.length;k++){			//		//}		//j=0这是错误的		//console.log("j"+j);		//alert("j"+j);		//alert("chk_ids.length"+chk_ids.length);因为我没有像老师一样，所以chk_ids.length=0		//alert("str.length"+str.length);		//字符串为0说明没有选择		//或者j==chk_id.length				if (str.length==0) {			alert("未选择！");			mod.setAttribute('data-target', '');		} else {			del_id.setAttribute('data-target', '#delete_modal');			//console.log("else str"+str);			del_id.setAttribute('href', 'menu_delete.jsp?str='+str);						//del_id.setAttribute('href', 'menu_delete.jsp?ids='+chk_ids);						//2.要把id_List传递到menu_delete.jsp			//3.打印出id_List的数据，显示在列表，checkbox。点击确定，form提交到MenuSaveServlet			//4.编写删除的数据库删除代码			//先写删除一条数据，再想删除多条数据？否则这里要2个if，一个是判断如果一个都没有，弹出对话框中的提示，一个是			//判断如果要删除多条数据的id需要怎么做，其实保存id不用hashMap和ArrayList，只是需要一个数组						//del_id.setAttribute('href', 'menu_delete.jsp?id='			//			+ chk_id[i].value);			//删除的逻辑有点不同。要遍历所有的选择的选项，然后就删除。要使用MenuSaveServlet。			//要2个list进行比较。就不可能是这样地址传递数据的id了						//地址栏传递的数组要如数组a[3]={1,2,3}			//循环且加上，以后就是string b=1,2,3,			//然后在你要用的页面对字符串经行切割、split（“，”）			//不如用session,但是这个实在javascript中啊，怎么可能用session？感觉应该不是这样做，太麻烦了，虽然能做			//但是如果不这样做，那么JavaScript中的数据又怎么交给JSp呢？还要定义传递的个数，否则根本就不知道传递了多少个参数。			//str = chk_ids.join("-");将数组变成字符串					}		$("#modify_modal").on("hidden.bs.modal", function() {			//清除数据避免被缓存			$(this).removeData("bs.modal");		});						//删除结束	}	</script></head>		<!--是否通过关闭按钮或者用Alt+F4退出	如果为刷新触发onbeforeunload事件，下面if语句不执行 	<body 	onbeforeunload="checkLeave()" >	 --> <body>	<div class="container-fluid"		style="padding-left: 0px; padding-right: 0px">		<div class="row-fluid">			<jsp:include page="top.jsp"></jsp:include>		</div>		<div class="row-fluid">			<div class="col-md-2" style="margin-top: 20">				<jsp:include page="left.html"></jsp:include>			</div>			<div class="col-md-10" style="margin-top: 20">			<div style="float: right">							<input class="btn btn-default btn-primary" type="button"								href="menu!insert.action" data-toggle="modal"								data-target="#insert_modal" value="新增"> 							<input								class="btn btn-default btn-primary" type="button" id="mod"								href="" data-toggle="modal" data-target="#modify_modal"								onclick="modify()" value="修改">							<input								class="btn btn-default btn-primary" type="button" id="del"								onclick="delete1()" data-toggle="modal" value="删除">						</div>				<table class="table table-striped table-bordered">					<caption>菜单列表</caption>					<thead>						<tr>							<th>选择</th>							<th>id</th>							<th>名称</th>							<th>url</th>							<th>ico</th>						</tr>					</thead>					<tbody>												<c:forEach items="${menuList}" var="menu">													<tr>								<td><input type="checkbox" name="chk_id" value="${menu.id}"/></td>								<td>${menu.id }</td>								<td>${menu.name}</td>								<td>${menu.url} </td>								<td>${menu.ico}</td>							</tr>						</c:forEach>					</tbody>				</table>			</div>		</div>	</div>	<!-- 新增-模态对话框 -->	<div class="modal fade" id="insert_modal">		<div class="modal-dialog">			<div class="modal-content">				<!-- 嵌入menu_insert.jsp页面内容 -->			</div>			<!-- 对话框内容部分 -->		</div>		<!-- /对话框-->	</div>	<!-- 修改-模态对话框 -->	<div class="modal fade" id="modify_modal">		<div class="modal-dialog">			<div class="modal-content">				<!-- 嵌入menu_modify.jsp页面内容 -->			</div>			<!-- 对话框内容部分 -->		</div>		<!-- /对话框-->	</div>		<!-- 删除对话框 -->		<div class="modal fade" id="delete_modal">		<div class="modal-dialog">			<div class="modal-content">				<!-- 嵌入menu_modify.jsp页面内容 -->			</div>			<!-- 对话框内容部分 -->		</div>		<!-- /对话框-->	</div></body></html>